axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_text(angle=0, color="black", size=16, face="bold"),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = c(1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 1900, 1950))
recon.and.prism
recon.and.prism <- ggplot(data=ar.nested[ar.nested$YEAR<1970,]) +
geom_hline(aes(yintercept=mean(ar.nested$RECON, na.rm=T)), color="#000000", size=0.2) +
geom_vline(aes(xintercept = 1800), linetype="dashed") +
geom_line(data=full.wint.prism, aes(x=Year, y=wint.prism), color="#E69F00", size=0.9) +
geom_line(aes(x=YEAR, y= RECON), alpha = 0.3, size=0.9,color="#0072B2")+
geom_line(aes(x=YEAR, y= X20LP), alpha=0.3, color="#000000", size=1.2)+
geom_line(data= ar.nested[ar.nested$YEAR >= 1800,],aes(x=YEAR, y= RECON), size=0.8,color="#0072B2") +
geom_line(data= ar.nested[ar.nested$YEAR >= 1800,],aes(x=YEAR, y= X20LP), size=1.2, color="#000000") +
geom_ribbon(aes(x=YEAR, ymin=RECON - RMSE, ymax= RECON + RMSE), alpha = 0.15, fill= "#0072B2") +
geom_ribbon(data=ar.nested[ar.nested$YEAR >= 1800 & ar.nested$YEAR<1970,],aes(x=YEAR, ymin=RECON - RMSE, ymax= RECON + RMSE), alpha = 0.3, fill="#0072B2") +
# geom_line(data=prism.wint.temp, aes(x=Year, y=PRISM), color="#E69F00", size = 0.9) +
labs(x="Year", y="JanApr Temp. (˚C)") +
#scale_colour_manual(name="Temperature",values=cols) +
scale_linetype_manual(values = c("solid", "dashed"), guide=F) +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_text(angle=0, color="black", size=16, face="bold"),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = c(1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 1900, 1950))
recon.and.prism
recon.and.prism <- ggplot(data=ar.nested[ar.nested$YEAR<1970,]) +
geom_hline(aes(yintercept=mean(ar.nested$RECON, na.rm=T)), color="#000000", size=0.35) +
geom_vline(aes(xintercept = 1800), linetype="dashed") +
geom_line(data=full.wint.prism, aes(x=Year, y=wint.prism), color="#E69F00", size=0.9) +
geom_line(aes(x=YEAR, y= RECON), alpha = 0.3, size=0.9,color="#0072B2")+
geom_line(aes(x=YEAR, y= X20LP), alpha=0.3, color="#000000", size=1.2)+
geom_line(data= ar.nested[ar.nested$YEAR >= 1800,],aes(x=YEAR, y= RECON), size=0.8,color="#0072B2") +
geom_line(data= ar.nested[ar.nested$YEAR >= 1800,],aes(x=YEAR, y= X20LP), size=1.2, color="#000000") +
geom_ribbon(aes(x=YEAR, ymin=RECON - RMSE, ymax= RECON + RMSE), alpha = 0.15, fill= "#0072B2") +
geom_ribbon(data=ar.nested[ar.nested$YEAR >= 1800 & ar.nested$YEAR<1970,],aes(x=YEAR, ymin=RECON - RMSE, ymax= RECON + RMSE), alpha = 0.3, fill="#0072B2") +
# geom_line(data=prism.wint.temp, aes(x=Year, y=PRISM), color="#E69F00", size = 0.9) +
labs(x="Year", y="JanApr Temp. (˚C)") +
#scale_colour_manual(name="Temperature",values=cols) +
scale_linetype_manual(values = c("solid", "dashed"), guide=F) +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_text(angle=0, color="black", size=16, face="bold"),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = c(1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 1900, 1950))
recon.and.prism
pdf("figures/big_recon_prism.pdf", width= 13, height = 8)
recon.and.prism
dev.off()
png("figures/big_recon_prism.png", width= 13, height = 8, unit="in", res = 300)
recon.and.prism
dev.off()
png(filename="figures/test.png", width=15, height= 8, units="in", res=300)
plot_grid(recon.and.prism, recon.depth, align = "v", nrow = 2, rel_heights = c(3/4, 1/4))
dev.off()
library(cowplot)
png(filename="figures/recon_prism_combo.png", width=15, height= 8, units="in", res=300)
plot_grid(recon.and.prism, recon.depth, align = "v", nrow = 2, rel_heights = c(3/4, 1/4))
dev.off()
recon.depth <- ggplot(data=ar.nested[ar.nested$YEAR<1970,]) +
geom_vline(aes(xintercept = 1800), linetype="dashed") +
geom_line(aes(x=YEAR, y=CRNS), size=1) +
labs(x="Year", y="Chronologies") +
#scale_colour_manual(name="Temperature",values=cols) +
scale_linetype_manual(values = c("solid", "dashed"), guide=F) +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_text(angle=0, color="black", size=16, face="bold"),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = c(1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 1900, 1950))
png(filename="figures/recon_prism_combo.png", width=15, height= 8, units="in", res=300)
plot_grid(recon.and.prism, recon.depth, align = "v", nrow = 2, rel_heights = c(3/4, 1/4))
dev.off()
recon.depth <- ggplot(data=ar.nested[ar.nested$YEAR<1970,]) +
geom_vline(aes(xintercept = 1800), linetype="dashed") +
geom_line(aes(x=YEAR, y=CRNS), size=1) +
labs(x="Year", y="Chronologies") +
#scale_colour_manual(name="Temperature",values=cols) +
scale_linetype_manual(values = c("solid", "dashed"), guide=F) +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_text(angle=0, color="black", size=16, face="bold"),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = c(1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 1900, 1950, 2000))
png(filename="figures/recon_prism_combo.png", width=15, height= 8, units="in", res=300)
plot_grid(recon.and.prism, recon.depth, align = "v", nrow = 2, rel_heights = c(3/4, 1/4))
dev.off()
recon.depth <- ggplot(data=ar.nested[ar.nested$YEAR<1970,]) +
geom_vline(aes(xintercept = 1800), linetype="dashed") +
geom_line(aes(x=YEAR, y=CRNS), size=1) +
labs(x="Year", y="Chronologies") +
#scale_colour_manual(name="Temperature",values=cols) +
scale_linetype_manual(values = c("solid", "dashed"), guide=F) +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_text(angle=0, color="black", size=16, face="bold"),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = c(1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 1900, 1950, 2000))
recon.depth
max(full.wint.prism$Year)
min(ar.nested$YEAR)
recon.depth <- ggplot(data=ar.nested[ar.nested$YEAR<1970,]) +
geom_vline(aes(xintercept = 1800), linetype="dashed") +
geom_line(aes(x=YEAR, y=CRNS), size=1) +
labs(x="Year", y="Chronologies") +
#scale_colour_manual(name="Temperature",values=cols) +
scale_linetype_manual(values = c("solid", "dashed"), guide=F) +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_text(angle=0, color="black", size=16, face="bold"),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(limits = c(min(ar.nested$YEAR), max(full.wint.prism$Year)),breaks  = c(1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 1900, 1950, 2000))
recon.depth
png(filename="figures/recon_prism_combo.png", width=15, height= 8, units="in", res=300)
plot_grid(recon.and.prism, recon.depth, align = "v", nrow = 2, rel_heights = c(3/4, 1/4))
dev.off()
recon.and.prism <- ggplot(data=ar.nested[ar.nested$YEAR<1970,]) +
geom_hline(aes(yintercept=mean(ar.nested$RECON, na.rm=T)), color="#000000", size=0.35) +
geom_vline(aes(xintercept = 1800), linetype="dashed") +
geom_line(data=full.wint.prism, aes(x=Year, y=wint.prism), color="#E69F00", size=0.9) +
geom_line(aes(x=YEAR, y= RECON), alpha = 0.3, size=0.9,color="#0072B2")+
geom_line(aes(x=YEAR, y= X20LP), alpha=0.3, color="#000000", size=1.2)+
geom_line(data= ar.nested[ar.nested$YEAR >= 1800,],aes(x=YEAR, y= RECON), size=0.8,color="#0072B2") +
geom_line(data= ar.nested[ar.nested$YEAR >= 1800,],aes(x=YEAR, y= X20LP), size=1.2, color="#000000") +
geom_ribbon(aes(x=YEAR, ymin=RECON - RMSE, ymax= RECON + RMSE), alpha = 0.15, fill= "#0072B2") +
geom_ribbon(data=ar.nested[ar.nested$YEAR >= 1800 & ar.nested$YEAR<1970,],aes(x=YEAR, ymin=RECON - RMSE, ymax= RECON + RMSE), alpha = 0.3, fill="#0072B2") +
# geom_line(data=prism.wint.temp, aes(x=Year, y=PRISM), color="#E69F00", size = 0.9) +
labs(x="Year", y="JanApr Temp. (˚C)") +
#scale_colour_manual(name="Temperature",values=cols) +
scale_linetype_manual(values = c("solid", "dashed"), guide=F) +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_text(angle=0, color="black", size=16, face="bold"),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = c(1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 1900, 1950, 2000))
png(filename="figures/recon_prism_combo.png", width=15, height= 8, units="in", res=300)
plot_grid(recon.and.prism, recon.depth, align = "v", nrow = 2, rel_heights = c(3/4, 1/4))
dev.off()
modern.recon.prism <- ggplot(data=ar.nested[ar.nested$YEAR<1970 & ar.nested$YEAR>1800,]) +
geom_hline(aes(yintercept=mean(ar.nested$RECON, na.rm=T)), color="#000000", size=0.35) +
geom_line(data=full.wint.prism, aes(x=Year, y=wint.prism), color="#E69F00", size=0.9) +
# geom_line(aes(x=YEAR, y= RECON), alpha = 0.4, size=0.8)+
# geom_line(aes(x=YEAR, y= X20LP), alpha=0.3, color="red", size=0.8)+
geom_line(data= ar.nested[ar.nested$YEAR >= 1800,],aes(x=YEAR, y= RECON), size=0.9, color="#0072B2") +
geom_line(data= ar.nested[ar.nested$YEAR >= 1800,],aes(x=YEAR, y= X20LP), size=1.2, color="#000000") +
# geom_ribbon(aes(x=YEAR, ymin=RECON - RMSE, ymax= RECON + RMSE), alpha = 0.2, fill= "grey50") +
geom_ribbon(data=ar.nested[ar.nested$YEAR >= 1800 & ar.nested$YEAR<1970,],aes(x=YEAR, ymin=RECON - RMSE, ymax= RECON + RMSE), alpha = 0.2, fill="#0072B2") +
# geom_line(data=prism.wint.temp, aes(x=Year, y=PRISM), color="#E69F00", size = 0.9) +
labs(x="Year", y="JanApr Temp. (˚C)") +
#scale_colour_manual(name="Temperature",values=cols) +
scale_linetype_manual(values = c("solid", "dashed"), guide=F) +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5, face="bold"),
axis.text.y=element_text(angle=0, color="black", size=16, face="bold"),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold")) +
scale_x_continuous(breaks  = c(1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 1900, 1950, 2000))
pdf("figures/modern_recon_prism.pdf", width= 13, height = 8)
modern.recon.prism
dev.off()
png("figures/modern_recon_prism.png", width= 13, height = 8, unit="in", res = 300)
modern.recon.prism
dev.off()
cbbPalette <- c("#56B4E9", "#009E73", "#0072B2", "#D55E00", "black")
actual.mean <- -5.884657 # The mean of the observed temperature record
recon.means.stack <- load("../pc_reg_recon/regional/r-analysis/processed_data/reconstructed_means.Rdata")
recon.data <- read.csv("../pc_reg_recon/regional/r-analysis/input_data/regional_act_vs_est.csv", header=T)
r.values <- read.csv("../pc_reg_recon/regional/r-analysis/input_data/recon_rvalues.csv", header=T)
ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=Year, y=actual), color="#E69F00", size=0.85, alpha=0.7)
ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=Year, y=actual), color="#E69F00", size=0.85, alpha=0.7) +
geom_line(aes(x=Year, y=estimate, color=test), size=0.95)
ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=actual, y=estimate), color=test)
summary(recon.data)
ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=actual, y=estimate, color=test))
ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=actual, y=estimate, color=test)) +
#geom_line(aes(x=Year, y=estimate, color=test), size=0.95) +
scale_color_manual(values=cbbPalette)
ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=actual, y=estimate, color=test)) +
stat_smooth(aes(x=actual, y=estimate), method="lm")
ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=actual, y=estimate, color=test)) +
stat_smooth(aes(x=actual, y=estimate), method="lm") +
#geom_line(aes(x=Year, y=estimate, color=test), size=0.95) +
scale_color_manual(values=cbbPalette)
ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=actual, y=estimate, color=test)) +
stat_smooth(aes(x=actual, y=estimate), method="lm", color="grey30") +
#geom_line(aes(x=Year, y=estimate, color=test), size=0.95) +
scale_color_manual(values=cbbPalette)
ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=actual, y=estimate, color=test)) +
stat_smooth(aes(x=actual, y=estimate), method="lm", color="grey30") +
#geom_line(aes(x=Year, y=estimate, color=test), size=0.95) +
scale_color_manual(values=cbbPalette) +
geom_text(data=r.values, aes(x=-8, y=-4, label=paste0("r = ", r.value), group=test), fontface="bold", size=5) +
labs(x="Actual JanApr Temp. (˚C)", y="Estimate JanApr Temp. (˚C)")
fig5.scatter <- ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=actual, y=estimate, color=test)) +
stat_smooth(aes(x=actual, y=estimate), method="lm", color="grey30") +
#geom_line(aes(x=Year, y=estimate, color=test), size=0.95) +
scale_color_manual(values=cbbPalette) +
geom_text(data=r.values, aes(x=-7, y=-4, label=paste0("r = ", r.value), group=test), fontface="bold", size=5) +
labs(x="Actual JanApr Temp. (˚C)", y="Estimate JanApr Temp. (˚C)") +
#scale_colour_manual(name="Temperature",values=cols) +
#scale_linetype_manual(values = c("solid", "dashed"), guide=F) +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5),
axis.text.y=element_text(angle=0, color="black", size=16),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold"))
fig5.scatter
fig5.scatter <- ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=actual, y=estimate, color=test)) +
stat_smooth(aes(x=actual, y=estimate), method="lm", color="grey30") +
#geom_line(aes(x=Year, y=estimate, color=test), size=0.95) +
scale_color_manual(values=cbbPalette) +
geom_text(data=r.values, aes(x=-7.5, y=-4, label=paste0("r = ", r.value), group=test), fontface="bold", size=5) +
labs(x="Actual JanApr Temp. (˚C)", y="Estimate JanApr Temp. (˚C)") +
#scale_colour_manual(name="Temperature",values=cols) +
#scale_linetype_manual(values = c("solid", "dashed"), guide=F) +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5),
axis.text.y=element_text(angle=0, color="black", size=16),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold"))
fig5.scatter
fig5.scatter <- ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=actual, y=estimate, color=test)) +
stat_smooth(aes(x=actual, y=estimate), method="lm", color="grey30") +
#geom_line(aes(x=Year, y=estimate, color=test), size=0.95) +
scale_color_manual(values=cbbPalette) +
geom_text(data=r.values, aes(x=-7.5, y=-4, label=paste0("r = ", r.value), group=test), fontface="bold", size=5) +
labs(x="Actual JanApr Temp. (˚C)", y="Estimate JanApr Temp. (˚C)") +
#scale_colour_manual(name="Temperature",values=cols) +
#scale_linetype_manual(values = c("solid", "dashed"), guide=F) +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5),
axis.text.y=element_text(angle=0, color="black", size=16),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="bottom",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold"))
fig5.scatter
fig5.scatter <- ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=actual, y=estimate, color=test)) +
stat_smooth(aes(x=actual, y=estimate), method="lm", color="grey30") +
#geom_line(aes(x=Year, y=estimate, color=test), size=0.95) +
scale_color_manual(values=cbbPalette) +
geom_text(data=r.values, aes(x=-7.5, y=-4, label=paste0("r = ", r.value), group=test), fontface="bold", size=5) +
labs(x="Actual JanApr Temp. (˚C)", y="Estimate JanApr Temp. (˚C)") +
#scale_colour_manual(name="Temperature",values=cols) +
#scale_linetype_manual(values = c("solid", "dashed"), guide=F) +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5),
axis.text.y=element_text(angle=0, color="black", size=16),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="none",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold"))
fig5.scatter <- ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=actual, y=estimate, color=test)) +
stat_smooth(aes(x=actual, y=estimate), method="lm", color="grey30") +
#geom_line(aes(x=Year, y=estimate, color=test), size=0.95) +
scale_color_manual(values=cbbPalette) +
geom_text(data=r.values, aes(x=-7.5, y=-4, label=paste0("r = ", r.value), group=test), fontface="bold", size=5) +
labs(x="Actual JanApr Temp. (˚C)", y="Estimate JanApr Temp. (˚C)") +
#scale_colour_manual(name="Temperature",values=cols) +
#scale_linetype_manual(values = c("solid", "dashed"), guide=F) +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5),
axis.text.y=element_text(angle=0, color="black", size=16),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="none",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold"))
fig5.scatter
png("figures/Figure5_scatter.png", width= 13, height = 8.5, unit="in", res = 300)
fig5.scatter
dev.off()
ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=actual, y=estimate, color=test), size=2)
fig5.scatter <- ggplot(data=recon.data) + facet_wrap(~test) +
geom_point(aes(x=actual, y=estimate, color=test), size=2) +
stat_smooth(aes(x=actual, y=estimate), method="lm", color="grey30") +
#geom_line(aes(x=Year, y=estimate, color=test), size=0.95) +
scale_color_manual(values=cbbPalette) +
geom_text(data=r.values, aes(x=-7.5, y=-4, label=paste0("r = ", r.value), group=test), fontface="bold", size=5) +
labs(x="Actual JanApr Temp. (˚C)", y="Estimate JanApr Temp. (˚C)") +
#scale_colour_manual(name="Temperature",values=cols) +
#scale_linetype_manual(values = c("solid", "dashed"), guide=F) +
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5),
axis.text.y=element_text(angle=0, color="black", size=16),
strip.text=element_text(face="bold", size=22),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="none",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=22),
legend.title = element_blank(),
legend.key = element_rect(fill = "white")) +
guides(fill=guide_legend(nrow=1, title="")) +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold"))
png("figures/Figure5_scatter.png", width= 13, height = 8.5, unit="in", res = 300)
fig5.scatter
dev.off()
summary(ar.nested)
setwd("~/Dropbox/Research/research_projects/canopy_class_climate")
# Results script for the NEUS canopy_class paper
# Loading in data frames
# Loading in all of the base stuff we need
library(mgcv)
source("0_Calculate_GAMM_Posteriors_Updated.R") # This is a slightly updated version from what you were using earlier
source("0_Calculate_GAMM_Derivs.R")
# Setting up the base dataframe we need
new.dat <- read.csv("processed_data/sensitivity_extaction_dataframe.csv")
#n <- 1000
predictors.all <- c("vpd.max", "tmean", "precip", "Species", "dbh.recon", "Canopy.Class", "spp.plot", "Site.Code", "Year", "PlotID", "spp.cc", "TreeID")
load("processed_data/gam_vpdmax_response_graph.Rdata")
load("processed_data/gam_results/gam_vpdmax.Rdata")
vpd.gam <- gam.vpdmax; rm(gam.vpdmax)
vpd.graph <- ci.terms.graph; rm(ci.terms.graph)
