geom_path(data=states,aes(x = Lon, y = Lat, group=group), color = "black", size=0.1) +
geom_point(aes(x=Lon, y=Lat), color = "red", size=2.5, alpha=0.75) +
geom_text(data = dat.map[!dat.map$Site.Code %in% c("NR", "HF"),], aes(x=Lon+0.25, y=Lat+0.25, label = paste("",as.character(Site.Code), sep="")), color="black", size=5,fontface="bold") +
geom_text(data = dat.map[dat.map$Site.Code %in% "NR",], aes(x=Lon-0.25, y=Lat-0.25, label = paste("",as.character(Site.Code), sep="")), color="black", size=5,fontface="bold") +
geom_text(data = dat.map[dat.map$Site.Code %in% "HF",], aes(x=Lon-0.25, y=Lat-0.25, label = paste("",as.character(Site.Code), sep="")), color="black", size=5,fontface="bold") +
# scale_color_manual(values="red", name="Data Type") +
theme_bw() +
theme(legend.position="none",
axis.text.x=element_text(angle=0, color="black", size=16, vjust= 0.5),
axis.text.y=element_text(angle=0, color="black", size=16)) +
scale_x_continuous(expand=c(0,0), name="Degrees Longitude", limits =c(lon.min - 0.25,lon.max +2.25)) +
scale_y_continuous(expand=c(0,0), name="Degrees Latitude", limits= c(lat.min - 1,lat.max + 1)) +
coord_equal() +
theme(axis.title.y= element_text(size=24, face="bold")) +
theme(axis.title.x= element_text(size=24, face="bold"))
fig1a
png("figures/pub_figs/fig1a.png", width= 13, height = 8.5, unit="in", res = 300)
fig1a
dev.off()
# png("figures/pub_figs/Figure1.png", width= 13, height = 8.5, unit="in", res = 300)
# grid.newpage()
# pushViewport(viewport(layout=grid.layout(nrow=1,ncol=2, widths=c(1.3,1,2))))
# print(fig1a, vp = viewport(layout.pos.row = 1, layout.pos.col=1))
# print(fig1b, vp = viewport(layout.pos.row = 1, layout.pos.col=2))
#
# dev.off()
plot_grid(fig1a, fig1b, align = c("v","h"), nrow = 1, rel_widths = c(0.4, 0.6), labels = c("A)", "B)"))
library(cowplot)
plot_grid(fig1a, fig1b, align = c("v","h"), nrow = 1, rel_widths = c(0.4, 0.6), labels = c("A)", "B)"))
png(file="figures/pub_figs/Figure1.png", width=15, height= 10, res=300, unit="in")
plot_grid(fig1a, fig1b, align = c("v","h"), nrow = 1, rel_widths = c(0.4, 0.6), labels = c("A)", "B)"))
dev.off()
png(file="figures/pub_figs/Figure1.png", width=15, height= 10, res=300, unit="in")
plot_grid(fig1a, fig1b, align = c("v","h"), nrow = 1, rel_widths = c(0.4, 0.6), labels = c("A)", "B)"))
dev.off()
# Loading in species gam data
load("processed_data/gam4_response_graph.Rdata")
ci.terms.graph$Canopy.Class <- recode(ci.terms.graph$Canopy.Class, "'Canopy'='Overstory'; 'I'='Middle'; 'U'='Understory'")
ci.terms.graph$Effect <- recode(ci.terms.graph$Effect, "'tmean'='Tmean';'precip'='Precip'")
ci.terms.graph$Canopy.Class <- factor(ci.terms.graph$Canopy.Class, levels= c("Overstory", "Middle", "Understory"))
ci.terms.graph$Effect <- factor(ci.terms.graph$Effect, levels= c("Tmean", "Precip", "dbh.recon"))
ci.terms.graph$Species <- factor(ci.terms.graph$Species, levels = c("TSCA", "FAGR", "ACRU", "QURU"))
cbbPalette <- c("#009E73", "#e79f00", "#9ad0f3", "#0072B2", "#D55E00")
fig3.combo <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% c("Tmean", "Precip"), ]) +
facet_grid(Species~Effect, scales = "free_x") +
geom_ribbon(aes(x=x, ymin=exp(lwr)*100, ymax=exp(upr)*100), fill= "black", alpha=0.25) +
geom_line(aes(x=x, y=exp(mean)*100), color="black")+
scale_fill_manual(values=cbbPalette, guide = guide_legend(title = ""))+
scale_color_manual(values=cbbPalette, guide = guide_legend(title = ""))+
geom_hline(yintercept=100, linetype="dashed") +
coord_cartesian(ylim=c(50, 150)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = expression(bold(paste("Temperature ("^"o", "C)"))), y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=18),
axis.text.y=element_text(angle=0, color="black", size=18),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
png("figures/pub_figs/Figure3_nosize_change_name.png", width=13, height=8, units="in", res=300)
fig3.combo
dev.off()
pdf("figures/pub_figs/Figure3_nosize_changename.pdf", width=13, height=8)
fig3.combo
dev.off()
load("processed_data/gam6_response_graph.Rdata")
ci.terms.graph$Canopy.Class <- recode(ci.terms.graph$Canopy.Class, "'Canopy'='Overstory'; 'I'='Middle'; 'U'='Understory'")
ci.terms.graph$Canopy.Class <- factor(ci.terms.graph$Canopy.Class, levels= c("Overstory", "Middle", "Understory"))
ci.terms.graph$Effect <- recode(ci.terms.graph$Effect, "'tmean'='Tmean';'precip'='Precip'")
ci.terms.graph$Effect <- factor(ci.terms.graph$Effect, levels= c("Tmean", "Precip", "dbh.recon"))
# DBH dwarfs Tmean and Precip
# will make 2 separate graphs and stitch together like ch2 of diss.
ci.terms.graph$Species <- factor(ci.terms.graph$Species, levels = c("TSCA", "FAGR", "ACRU", "QURU"))
fig4.combo <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% c("Tmean", "Precip"), ]) +
facet_grid(Species~Effect, scales = "free_x") +
#geom_vline(aes(x=ci.terms.graph$x[which(ci.terms.graph$Effect=="Tmean" & ci.terms.graph$mean==0)])) +
geom_ribbon(aes(x=x, ymin=exp(lwr)*100, ymax=exp(upr)*100, fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean)*100, color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
geom_hline(yintercept=100, linetype="dashed") +
coord_cartesian(ylim=c(50, 150)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = expression(bold(paste("Temperature ("^"o", "C)"))), y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=18),
axis.text.y=element_text(angle=0, color="black", size=18),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
png("figures/pub_figs/Figure4_nosize_change_name.png", width=13, height=8, units="in", res=300)
fig4.combo
dev.off()
pdf("figures/pub_figs/Figure4_nosize_changename.pdf", width=13, height=8)
fig4.combo
dev.off()
# Temperature
fig4.t <-  ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% "tmean", ]) +
facet_wrap(~Species) +
geom_ribbon(aes(x=x, ymin=exp(lwr)*100, ymax=exp(upr)*100, fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean)*100, color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"))+
geom_hline(yintercept=100, linetype="dashed") +
coord_cartesian(ylim=c(50, 150)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = expression(bold(paste("Temperature ("^"o", "C)"))), y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=24),
legend.key = element_rect(fill = "white")) +
guides(color=guide_legend(nrow=1))+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
fig4.p <-  ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% "precip", ]) +
facet_wrap(~Species) +
geom_ribbon(aes(x=x, ymin=exp(lwr)*100, ymax=exp(upr)*100, fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean)*100, color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
geom_hline(yintercept=100, linetype="dashed") +
coord_cartesian(ylim=c(50, 150)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = "Precipitation (mm)", y=element_blank())+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))	+
theme(axis.text.y=element_blank())
# DBH fill by species-- turning into Figure 5
spp.palette <- c("#009E73", "#e79f00", "#9ad0f3", "#0072B2", "#D55E00")
figS1.dbh <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% "dbh.recon", ]) +
# facet_wrap(~Species) +
geom_ribbon(aes(x=x, ymin=exp(lwr)*100, ymax=exp(upr)*100, fill=Species), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean)*100, color=Species))+
scale_fill_manual(values=spp.palette)+
scale_color_manual(values=spp.palette)+
geom_hline(yintercept=100, linetype="dashed") +
coord_cartesian(ylim=c(0, 1500)) +
labs(x = "DBH (cm)", y = "Effect on BAI (%)")+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
#axis.text.y=element_text(angle=0, color="black", size=rel(1)),
strip.text=element_blank(),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=24),
legend.key = element_rect(fill = "white")) +
guides(color=guide_legend(ncol=1, title=""), fill=guide_legend(title="")) +
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
png("figures/pub_figs/FigureS1.png", width=13, height=8, units="in", res=300)
figS1.dbh
dev.off()
pdf("figures/pub_figs/FigureS1.pdf", width=13, height=8)
figS1.dbh
dev.off()
# # Stitching together
# pdf("figures/submission1_figs/Figure3_combined.pdf", height = 8, width = 13)
# grid.newpage()
# pushViewport(viewport(layout=grid.layout(nrow=1,ncol=2, widths=c(1.3,1.3))))
# print(fig3.t, vp = viewport(layout.pos.row = 1, layout.pos.col=1))
# print(fig3.p, vp = viewport(layout.pos.row = 1, layout.pos.col=2))
# #print(fig3.dbh + theme(plot.margin=unit(c(0.5,0,0.7,0),"lines")), vp = viewport(layout.pos.row = 1, layout.pos.col=3))
# dev.off()
fig4.clim <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% c("tmean", "precip"), ]) +
facet_grid(Species~Effect, scales="free_x") +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Canopy.Class))+
scale_fill_manual(values=c("#0072B2", "#009E73", "#E69F00"))+
scale_color_manual(values=c("#0072B2", "#009E73", "#E69F00"))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
theme_bw()+
labs(x = "Climate Variable", y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))
# ylim(-0.1,2.1)
library(car)
load("processed_data/gam_vpdmax_response_graph.Rdata")
vpd.graph <- ci.terms.graph
summary(vpd.graph)
vpd.graph$Canopy.Class <- recode(vpd.graph$Canopy.Class, "'Canopy'='Overstory'; 'I'='Middle';'U'='Understory'")
vpd.graph$Canopy.Class <- factor(vpd.graph$Canopy.Class, levels= c("Overstory", "Middle", "Understory"))
vpd.graph$Species <- factor(vpd.graph$Species, levels = c("TSCA", "FAGR", "ACRU", "QURU"))
fig5 <- ggplot(data=vpd.graph[vpd.graph$Effect %in% "vpd.max", ]) +
facet_wrap(~Species) +
geom_ribbon(aes(x=x/100, ymin=exp(lwr)*100, ymax=exp(upr)*100, fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x/100, y=exp(mean)*100, color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"),guide = guide_legend(title = ""))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"),guide = guide_legend(title = ""))+
geom_hline(yintercept=100, linetype="dashed") +
coord_cartesian(ylim=c(50, 150)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = "VPDmax (kPa)", y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
png("figures/pub_figs/FigureS2.png", width=13, height=8, units="in", res=300)
fig5
dev.off()
pdf("figures/pub_figs/FigureS2a.pdf", width=13, height=8)
fig5
dev.off()
# Try merging temp precip and VPD into one figure
vpd.graph2 <- vpd.graph
vpd.graph2$x <- vpd.graph2$x/100
franken.fig <- rbind(ci.terms.graph[ci.terms.graph$Effect %in% c("Tmean", "Precip"),], vpd.graph2[vpd.graph2$Effect %in% "vpd.max",])
summary(franken.fig)
franken.fig$Effect <- recode(franken.fig$Effect, "'vpd.max'='VPDmax'")
franken.fig$Effect <- factor(franken.fig$Effect, levels=c("Tmean", "Precip", "VPDmax"))
franken.graph <- ggplot(data=franken.fig[franken.fig$Effect %in% c("VPDmax", "Tmean", "Precip"), ]) +
facet_grid(Species~Effect, scales="free_x") +
geom_ribbon(aes(x=x, ymin=exp(lwr)*100, ymax=exp(upr)*100, fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean)*100, color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"),guide = guide_legend(title = ""))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"),guide = guide_legend(title = ""))+
geom_hline(yintercept=100, linetype="dashed") +
coord_cartesian(ylim=c(50, 150)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = "VPDmax (kPa)", y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
franken.graph
summary(franken.fig)
franken.fig <- rbind(ci.terms.graph[ci.terms.graph$Effect %in% c("Tmean", "Precip"),], vpd.graph2[vpd.graph2$Effect %in% "vpd.max",])
summary(franken.fig)
franken.graph
fig5
load("processed_data/gam6_response_graph.Rdata")
ci.terms.graph$Canopy.Class <- recode(ci.terms.graph$Canopy.Class, "'Canopy'='Overstory'; 'I'='Middle'; 'U'='Understory'")
ci.terms.graph$Canopy.Class <- factor(ci.terms.graph$Canopy.Class, levels= c("Overstory", "Middle", "Understory"))
ci.terms.graph$Effect <- recode(ci.terms.graph$Effect, "'tmean'='Tmean';'precip'='Precip'")
ci.terms.graph$Effect <- factor(ci.terms.graph$Effect, levels= c("Tmean", "Precip", "dbh.recon"))
# DBH dwarfs Tmean and Precip
# will make 2 separate graphs and stitch together like ch2 of diss.
ci.terms.graph$Species <- factor(ci.terms.graph$Species, levels = c("TSCA", "FAGR", "ACRU", "QURU"))
fig4.combo <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% c("Tmean", "Precip"), ]) +
facet_grid(Species~Effect, scales = "free_x") +
#geom_vline(aes(x=ci.terms.graph$x[which(ci.terms.graph$Effect=="Tmean" & ci.terms.graph$mean==0)])) +
geom_ribbon(aes(x=x, ymin=exp(lwr)*100, ymax=exp(upr)*100, fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean)*100, color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
geom_hline(yintercept=100, linetype="dashed") +
coord_cartesian(ylim=c(50, 150)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = expression(bold(paste("Temperature ("^"o", "C)"))), y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=18),
axis.text.y=element_text(angle=0, color="black", size=18),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
png("figures/pub_figs/Figure4_nosize_change_name.png", width=13, height=8, units="in", res=300)
fig4.combo
dev.off()
pdf("figures/pub_figs/Figure4_nosize_changename.pdf", width=13, height=8)
fig4.combo
dev.off()
# Temperature
fig4.t <-  ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% "tmean", ]) +
facet_wrap(~Species) +
geom_ribbon(aes(x=x, ymin=exp(lwr)*100, ymax=exp(upr)*100, fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean)*100, color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"))+
geom_hline(yintercept=100, linetype="dashed") +
coord_cartesian(ylim=c(50, 150)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = expression(bold(paste("Temperature ("^"o", "C)"))), y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=24),
legend.key = element_rect(fill = "white")) +
guides(color=guide_legend(nrow=1))+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
fig4.p <-  ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% "precip", ]) +
facet_wrap(~Species) +
geom_ribbon(aes(x=x, ymin=exp(lwr)*100, ymax=exp(upr)*100, fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean)*100, color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
geom_hline(yintercept=100, linetype="dashed") +
coord_cartesian(ylim=c(50, 150)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = "Precipitation (mm)", y=element_blank())+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))	+
theme(axis.text.y=element_blank())
# DBH fill by species-- turning into Figure 5
spp.palette <- c("#009E73", "#e79f00", "#9ad0f3", "#0072B2", "#D55E00")
figS1.dbh <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% "dbh.recon", ]) +
# facet_wrap(~Species) +
geom_ribbon(aes(x=x, ymin=exp(lwr)*100, ymax=exp(upr)*100, fill=Species), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean)*100, color=Species))+
scale_fill_manual(values=spp.palette)+
scale_color_manual(values=spp.palette)+
geom_hline(yintercept=100, linetype="dashed") +
coord_cartesian(ylim=c(0, 1500)) +
labs(x = "DBH (cm)", y = "Effect on BAI (%)")+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
#axis.text.y=element_text(angle=0, color="black", size=rel(1)),
strip.text=element_blank(),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=24),
legend.key = element_rect(fill = "white")) +
guides(color=guide_legend(ncol=1, title=""), fill=guide_legend(title="")) +
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
png("figures/pub_figs/FigureS1.png", width=13, height=8, units="in", res=300)
figS1.dbh
dev.off()
pdf("figures/pub_figs/FigureS1.pdf", width=13, height=8)
figS1.dbh
dev.off()
# # Stitching together
# pdf("figures/submission1_figs/Figure3_combined.pdf", height = 8, width = 13)
# grid.newpage()
# pushViewport(viewport(layout=grid.layout(nrow=1,ncol=2, widths=c(1.3,1.3))))
# print(fig3.t, vp = viewport(layout.pos.row = 1, layout.pos.col=1))
# print(fig3.p, vp = viewport(layout.pos.row = 1, layout.pos.col=2))
# #print(fig3.dbh + theme(plot.margin=unit(c(0.5,0,0.7,0),"lines")), vp = viewport(layout.pos.row = 1, layout.pos.col=3))
# dev.off()
fig4.clim <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% c("tmean", "precip"), ]) +
facet_grid(Species~Effect, scales="free_x") +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Canopy.Class))+
scale_fill_manual(values=c("#0072B2", "#009E73", "#E69F00"))+
scale_color_manual(values=c("#0072B2", "#009E73", "#E69F00"))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
theme_bw()+
labs(x = "Climate Variable", y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))
# ylim(-0.1,2.1)
# Try merging temp precip and VPD into one figure
vpd.graph2 <- vpd.graph
vpd.graph2$x <- vpd.graph2$x/100
franken.fig <- rbind(ci.terms.graph[ci.terms.graph$Effect %in% c("Tmean", "Precip"),], vpd.graph2[vpd.graph2$Effect %in% "vpd.max",])
summary(franken.fig)
franken.fig$Effect <- recode(franken.fig$Effect, "'vpd.max'='VPDmax'")
franken.fig$Effect <- factor(franken.fig$Effect, levels=c("Tmean", "Precip", "VPDmax"))
franken.graph <- ggplot(data=franken.fig[franken.fig$Effect %in% c("VPDmax", "Tmean", "Precip"), ]) +
facet_grid(Species~Effect, scales="free_x") +
geom_ribbon(aes(x=x, ymin=exp(lwr)*100, ymax=exp(upr)*100, fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean)*100, color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"),guide = guide_legend(title = ""))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"),guide = guide_legend(title = ""))+
geom_hline(yintercept=100, linetype="dashed") +
coord_cartesian(ylim=c(50, 150)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = "VPDmax (kPa)", y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
franken.graph
pdf(file="figures/pub_figs/franken_graph.pdf", width=13, height=10)
franken.graph
dev.off()
