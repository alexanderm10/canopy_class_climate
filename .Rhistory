########################################################################
load("processed_data/gam6_response_graph.Rdata")
ci.terms.graph$Canopy.Class <- recode(ci.terms.graph$Canopy.Class, "'I'='Intermediate'; 'U'='Understory'")
ci.terms.graph$Effect <- recode(ci.terms.graph$Effect, "'tmean'='Tmean';'precip'='Precip'")
ci.terms.graph$Effect <- factor(ci.terms.graph$Effect, levels= c("Tmean", "Precip", "dbh.recon"))
# DBH dwarfs Tmean and Precip
# will make 2 separate graphs and stitch together like ch2 of diss.
fig4.combo <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% c("Tmean", "Precip"), ]) +
facet_grid(Species~Effect, scales = "free_x") +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = expression(bold(paste("Temperature ("^"o", "C)"))), y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
png("figures/pub_figs/Figure4_nosize_change_name.png", width=13, height=8, units="in", res=300)
fig4.combo
dev.off()
pdf("figures/pub_figs/Figure4_nosize_changename.pdf", width=13, height=8)
fig4.combo
dev.off()
# Temperature
fig4.t <-  ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% "tmean", ]) +
facet_wrap(~Species) +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = expression(bold(paste("Temperature ("^"o", "C)"))), y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=24),
legend.key = element_rect(fill = "white")) +
guides(color=guide_legend(nrow=1))+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
fig4.p <-  ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% "precip", ]) +
facet_wrap(~Species) +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = "Precipitation (mm)", y=element_blank())+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))	+
theme(axis.text.y=element_blank())
# DBH fill by species-- turning into Figure 5
spp.palette <- c("#009E73", "#e79f00", "#9ad0f3", "#0072B2", "#D55E00")
figS1.dbh <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% "dbh.recon", ]) +
# facet_wrap(~Species) +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Species), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Species))+
scale_fill_manual(values=spp.palette)+
scale_color_manual(values=spp.palette)+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0, 15)) +
labs(x = "DBH (cm)", y = NULL)+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
#axis.text.y=element_text(angle=0, color="black", size=rel(1)),
strip.text=element_blank(),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=24),
legend.key = element_rect(fill = "white")) +
guides(color=guide_legend(ncol=1, title=""), fill=guide_legend(title="")) +
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
png("figures/pub_figs/FigureS1.png", width=13, height=8, units="in", res=300)
figS1.dbh
dev.off()
pdf("figures/pub_figs/FigureS1.pdf", width=13, height=8)
figS1.dbh
dev.off()
# # Stitching together
# pdf("figures/submission1_figs/Figure3_combined.pdf", height = 8, width = 13)
# grid.newpage()
# pushViewport(viewport(layout=grid.layout(nrow=1,ncol=2, widths=c(1.3,1.3))))
# print(fig3.t, vp = viewport(layout.pos.row = 1, layout.pos.col=1))
# print(fig3.p, vp = viewport(layout.pos.row = 1, layout.pos.col=2))
# #print(fig3.dbh + theme(plot.margin=unit(c(0.5,0,0.7,0),"lines")), vp = viewport(layout.pos.row = 1, layout.pos.col=3))
# dev.off()
fig4.clim <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% c("tmean", "precip"), ]) +
facet_grid(Species~Effect, scales="free_x") +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Canopy.Class))+
scale_fill_manual(values=c("#0072B2", "#009E73", "#E69F00"))+
scale_color_manual(values=c("#0072B2", "#009E73", "#E69F00"))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
theme_bw()+
labs(x = "Climate Variable", y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))
# ylim(-0.1,2.1)
##################
# Figure 5 VPD sensitivity Curves
###################
library(car)
load("processed_data/gam_vpdmax_response_graph.Rdata")
vpd.graph <- ci.terms.graph
summary(vpd.graph)
vpd.graph$Canopy.Class <- recode(vpd.graph$Canopy.Class, "'I'='Intermediate';'U'='Understory'")
fig5 <- ggplot(data=vpd.graph[vpd.graph$Effect %in% "vpd.max", ]) +
facet_wrap(~Species) +
geom_ribbon(aes(x=x/100, ymin=exp(lwr), ymax=exp(upr), fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x/100, y=exp(mean), color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"),guide = guide_legend(title = ""))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"),guide = guide_legend(title = ""))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = "VPDmax (kPa)", y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
png("figures/pub_figs/Figure5.png", width=13, height=8, units="in", res=300)
fig5
dev.off()
pdf("figures/pub_figs/Figure5.pdf", width=13, height=8)
fig5
dev.off()
library(ggplot2); library(maps)
library(car)
library(gridExtra)
library(grid)
########################
# Figure 3 Species Responses
########################
# Loading in species gam data
load("processed_data/gam4_response_graph.Rdata")
ci.terms.graph$Canopy.Class <- recode(ci.terms.graph$Canopy.Class, "'I'='Intermediate'; 'U'='Understory'")
ci.terms.graph$Effect <- recode(ci.terms.graph$Effect, "'tmean'='Tmean';'precip'='Precip'")
ci.terms.graph$Effect <- factor(ci.terms.graph$Effect, levels= c("Tmean", "Precip", "dbh.recon"))
cbbPalette <- c("#009E73", "#e79f00", "#9ad0f3", "#0072B2", "#D55E00")
fig3.combo <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% c("Tmean", "Precip"), ]) +
facet_grid(~Effect, scales = "free_x") +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Species), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Species))+
scale_fill_manual(values=cbbPalette, guide = guide_legend(title = ""))+
scale_color_manual(values=cbbPalette, guide = guide_legend(title = ""))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = expression(bold(paste("Temperature ("^"o", "C)"))), y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
png("figures/pub_figs/Figure3_nosize_change_name.png", width=13, height=8, units="in", res=300)
fig3.combo
dev.off()
pdf("figures/pub_figs/Figure3_nosize_changename.pdf", width=13, height=8)
fig3.combo
dev.off()
########################################################################
# Figure 4
# Sensitivity curves for Tmean, Precip, Size
########################################################################
load("processed_data/gam6_response_graph.Rdata")
ci.terms.graph$Canopy.Class <- recode(ci.terms.graph$Canopy.Class, "'I'='Intermediate'; 'U'='Understory'")
ci.terms.graph$Effect <- recode(ci.terms.graph$Effect, "'tmean'='Tmean';'precip'='Precip'")
ci.terms.graph$Effect <- factor(ci.terms.graph$Effect, levels= c("Tmean", "Precip", "dbh.recon"))
# DBH dwarfs Tmean and Precip
# will make 2 separate graphs and stitch together like ch2 of diss.
fig4.combo <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% c("Tmean", "Precip"), ]) +
facet_grid(Species~Effect, scales = "free_x") +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = expression(bold(paste("Temperature ("^"o", "C)"))), y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
png("figures/pub_figs/Figure4_nosize_change_name.png", width=13, height=8, units="in", res=300)
fig4.combo
dev.off()
pdf("figures/pub_figs/Figure4_nosize_changename.pdf", width=13, height=8)
fig4.combo
dev.off()
# Temperature
fig4.t <-  ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% "tmean", ]) +
facet_wrap(~Species) +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = expression(bold(paste("Temperature ("^"o", "C)"))), y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=24),
legend.key = element_rect(fill = "white")) +
guides(color=guide_legend(nrow=1))+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
fig4.p <-  ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% "precip", ]) +
facet_wrap(~Species) +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"), guide = guide_legend(title = ""))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = "Precipitation (mm)", y=element_blank())+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))	+
theme(axis.text.y=element_blank())
# DBH fill by species-- turning into Figure 5
spp.palette <- c("#009E73", "#e79f00", "#9ad0f3", "#0072B2", "#D55E00")
figS1.dbh <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% "dbh.recon", ]) +
# facet_wrap(~Species) +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Species), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Species))+
scale_fill_manual(values=spp.palette)+
scale_color_manual(values=spp.palette)+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0, 15)) +
labs(x = "DBH (cm)", y = NULL)+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
#axis.text.y=element_text(angle=0, color="black", size=rel(1)),
strip.text=element_blank(),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=24),
legend.key = element_rect(fill = "white")) +
guides(color=guide_legend(ncol=1, title=""), fill=guide_legend(title="")) +
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
png("figures/pub_figs/FigureS1.png", width=13, height=8, units="in", res=300)
figS1.dbh
dev.off()
pdf("figures/pub_figs/FigureS1.pdf", width=13, height=8)
figS1.dbh
dev.off()
# # Stitching together
# pdf("figures/submission1_figs/Figure3_combined.pdf", height = 8, width = 13)
# grid.newpage()
# pushViewport(viewport(layout=grid.layout(nrow=1,ncol=2, widths=c(1.3,1.3))))
# print(fig3.t, vp = viewport(layout.pos.row = 1, layout.pos.col=1))
# print(fig3.p, vp = viewport(layout.pos.row = 1, layout.pos.col=2))
# #print(fig3.dbh + theme(plot.margin=unit(c(0.5,0,0.7,0),"lines")), vp = viewport(layout.pos.row = 1, layout.pos.col=3))
# dev.off()
fig4.clim <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% c("tmean", "precip"), ]) +
facet_grid(Species~Effect, scales="free_x") +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Canopy.Class))+
scale_fill_manual(values=c("#0072B2", "#009E73", "#E69F00"))+
scale_color_manual(values=c("#0072B2", "#009E73", "#E69F00"))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
theme_bw()+
labs(x = "Climate Variable", y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5))
# ylim(-0.1,2.1)
##################
# Figure 5 VPD sensitivity Curves
###################
library(car)
load("processed_data/gam_vpdmax_response_graph.Rdata")
vpd.graph <- ci.terms.graph
summary(vpd.graph)
vpd.graph$Canopy.Class <- recode(vpd.graph$Canopy.Class, "'I'='Intermediate';'U'='Understory'")
fig5 <- ggplot(data=vpd.graph[vpd.graph$Effect %in% "vpd.max", ]) +
facet_wrap(~Species) +
geom_ribbon(aes(x=x/100, ymin=exp(lwr), ymax=exp(upr), fill=Canopy.Class), alpha=0.5) +
geom_line(aes(x=x/100, y=exp(mean), color=Canopy.Class))+
scale_fill_manual(values=c("#E69F00","#009E73", "#0072B2"),guide = guide_legend(title = ""))+
scale_color_manual(values=c("#E69F00","#009E73", "#0072B2"),guide = guide_legend(title = ""))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = "VPDmax (kPa)", y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
png("figures/pub_figs/Figure5.png", width=13, height=8, units="in", res=300)
fig5
dev.off()
pdf("figures/pub_figs/Figure5.pdf", width=13, height=8)
fig5
dev.off()
# Loading in species gam data
load("processed_data/gam4_response_graph.Rdata")
ci.terms.graph$Canopy.Class <- recode(ci.terms.graph$Canopy.Class, "'I'='Intermediate'; 'U'='Understory'")
ci.terms.graph$Effect <- recode(ci.terms.graph$Effect, "'tmean'='Tmean';'precip'='Precip'")
ci.terms.graph$Effect <- factor(ci.terms.graph$Effect, levels= c("Tmean", "Precip", "dbh.recon"))
cbbPalette <- c("#009E73", "#e79f00", "#9ad0f3", "#0072B2", "#D55E00")
ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% c("Tmean", "Precip"), ]) +
facet_grid(Species~Effect, scales = "free_x") +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Species), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Species))+
scale_fill_manual(values=cbbPalette, guide = guide_legend(title = ""))+
scale_color_manual(values=cbbPalette, guide = guide_legend(title = ""))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = expression(bold(paste("Temperature ("^"o", "C)"))), y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
fig3.combo <- ggplot(data=ci.terms.graph[ci.terms.graph$Effect %in% c("Tmean", "Precip"), ]) +
facet_grid(Species~Effect, scales = "free_x") +
geom_ribbon(aes(x=x, ymin=exp(lwr), ymax=exp(upr), fill=Species), alpha=0.5) +
geom_line(aes(x=x, y=exp(mean), color=Species))+
scale_fill_manual(values=cbbPalette, guide = guide_legend(title = ""))+
scale_color_manual(values=cbbPalette, guide = guide_legend(title = ""))+
geom_hline(yintercept=1, linetype="dashed") +
coord_cartesian(ylim=c(0.5, 1.5)) +
# scale_colour_manual("", values = cbbPalette) +
# scale_fill_manual("", values = cbbPalette) +
labs(x = expression(bold(paste("Temperature ("^"o", "C)"))), y = expression(bold(paste("Effect on BAI (%)"))))+
theme(axis.line=element_line(color="black"),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank(),
axis.text.x=element_text(angle=0, color="black", size=22),
axis.text.y=element_text(angle=0, color="black", size=22),
strip.text=element_text(face="bold", size=18),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
legend.position="top",
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size=18),
legend.key = element_rect(fill = "white")) +
#guides(color=guide_legend(nrow=1),)+
theme(axis.title.x = element_text(size=22, face="bold"),
axis.title.y= element_text(size=22, face="bold"))
png("figures/pub_figs/Figure3_nosize_change_name.png", width=13, height=8, units="in", res=300)
fig3.combo
dev.off()
pdf("figures/pub_figs/Figure3_nosize_changename.pdf", width=13, height=8)
fig3.combo
dev.off()
